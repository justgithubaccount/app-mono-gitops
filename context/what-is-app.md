–ö–æ–Ω–µ—á–Ω–æ. –¢—ã –≥–æ–≤–æ—Ä–∏—à—å –æ **—Å–º—ã—Å–ª–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** —Ç–∏–ø–∞ `App of Apps + ApplicationSet`, –≥–¥–µ –≤—Å—ë —Ä–∞–∑–ª–æ–∂–µ–Ω–æ –ø–æ –ø–∞–ø–∫–∞–º `infra/`, `clusters/`, `base/`, `services/` –∏ —Ç.–¥., –∫–∞–∫ —É `devOwlish`. –î–∞–≤–∞–π –æ–±—ä—è—Å–Ω—é **–≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –ª–æ–≥–∏–∫—É** —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ ‚Äî —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å –∏ –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ:

---

## üöÄ –≠—Ç–æ –¥–∞—ë—Ç —Ç–µ–±–µ:

| –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å                          | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è                                                                                                                                                                        |
| ------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 100+ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤** | –° –ø–æ–º–æ—â—å—é `ApplicationSet` –º–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å `Application` –Ω–∞ –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Ç–µ—Ä, —Ä–µ–≥–∏–æ–Ω, namespace –∏–ª–∏ —Å–µ—Ä–≤–∏—Å.                                                       |
| **–†–∞–∑–¥–µ–ª—è—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å**        | –£ –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞/–æ–∫—Ä—É–∂–µ–Ω–∏—è ‚Äî —Å–≤–æ—è –ø–∞–ø–∫–∞, —Å–≤–æ–π `Application`, —Å–≤–æ–∏ `RoleBinding`-–∏. –û–¥–∏–Ω —á–∞—Ç –Ω–µ –º–æ–∂–µ—Ç –∑–∞—Ç–µ—Ä–µ—Ç—å –∏–Ω–≥—Ä–µ—Å—Å.                                                           |
| **Git = –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã**            | –í—Å—è –∏–Ω—Ñ—Ä–∞ (`longhorn`, `grafana`, `ingress`, `cert-manager`, `chat-api`, `secrets`, `Issuer`, `CRDs`) ‚Äî **–≤ Git**, —á–µ—Ä–µ–∑ ArgoCD –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ –∫–ª–∞—Å—Ç–µ—Ä—ã. –ù–∏–∫–∞–∫–∏—Ö `kubectl apply`. |
| **–ü—Ä–æ–∑—Ä–∞—á–Ω–∞—è —Ä–µ–≤—å—é/–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**    | –û—Ç–∫—Ä—ã–≤–∞–µ—à—å Git –∏ –≤–∏–¥–∏—à—å –≤—Å—ë: –∫—Ç–æ –≤–ª–∞–¥–µ–µ—Ç, –≥–¥–µ –¥–µ–ø–ª–æ–∏—Ç—Å—è, –∫—É–¥–∞, —Å –∫–∞–∫–∏–º helm-values –∏–ª–∏ overlay.                                                                                   |
| **Preview, Dev, Prod –æ–∫—Ä—É–∂–µ–Ω–∏—è**     | –†–∞–∑–ª–æ–∂–µ–Ω—ã –≤ `clusters/dev`, `clusters/prod` ‚Äî —ç—Ç–æ `overlays`, –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω—è—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Helm/Kustomize –∏ —É–∫–∞–∑—ã–≤–∞—é—Ç —Å–≤–æ–π `destination`.                                             |

---

## üß† –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≥–æ–ª–æ–≤–µ (–∏ –≤ Git):

### üß± 1. –°–ª–æ–∏

```shell
infra/
‚îú‚îÄ‚îÄ _main_apps/             # Root Application'—ã ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ base/                   # –û–±—â–∏–µ –≤–µ—â–∏: CRDs, Issuer, longhorn
‚îú‚îÄ‚îÄ addons/                 # –í–µ–Ω–¥–æ—Ä–Ω–æ–µ: ingress, cert-manager, external-dns
‚îú‚îÄ‚îÄ services/               # –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã: chat-api, litellm –∏ –¥—Ä.
‚îú‚îÄ‚îÄ clusters/               # –ü–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º: dev, stage, prod
‚îú‚îÄ‚îÄ application-sets/       # –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è Application'–æ–≤
‚îî‚îÄ‚îÄ kustomization.yaml      # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ glue-—Ñ–∞–π–ª
```

---

### üì¶ 2. –ü—Ä–∏–º–µ—Ä: –¥–µ–ø–ª–æ–π chat-api –≤ dev –∏ prod

1. `services/chat-api/application.yaml` ‚Äî —à–∞–±–ª–æ–Ω `Application`, helm –∏–ª–∏ kustomize.
2. `clusters/dev/chat-api.yaml` ‚Äî –∫–æ–ø–∏—è `Application`, –Ω–æ —Å `destination: dev`.
3. `clusters/prod/chat-api.yaml` ‚Äî –∫–æ–ø–∏—è —Å `destination: prod`.
4. –ò–ª–∏ —Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—à—å –≤—Å—ë —á–µ—Ä–µ–∑ `ApplicationSet` –∏–∑ `application-sets/chat-api.yaml`.

---

### üîê 3. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞

* –í ArgoCD RBAC –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å: dev-–∫–æ–º–∞–Ω–¥–∞ –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ `services/chat-api`, –∞ –ø—Ä–æ–¥-–∫–æ–º–∞–Ω–¥–∞ ‚Äî —Ç–æ–ª—å–∫–æ `addons/grafana`.
* –í Git PR –º–æ–≥—É—Ç —Å–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–≤–æ–π –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥ ‚Äî –∏ —ç—Ç–æ —É–∂–µ **–∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ Git**.

---

### üß© 4. –†–∞–∑–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã = –ø—Ä–æ—Å—Ç–æ –µ—â—ë –æ–¥–∏–Ω `destination`

```yaml
spec:
  destination:
    server: https://k8s-dev.example.com
    namespace: chat-api
```

–ò–ª–∏ —Å `ApplicationSet`:

```yaml
generators:
  - list:
      elements:
        - cluster: dev
          url: https://k8s-dev.example.com
        - cluster: prod
          url: https://k8s-prod.example.com
```

---

## ‚úÖ –°–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ:

> –≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚Äî **–Ω–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ –ø–æ—Ä—è–¥–æ–∫ –≤ —Ñ–∞–π–ª–∞—Ö**, –æ–Ω–∞ –æ—Ç—Ä–∞–∂–∞–µ—Ç **–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∫–æ–º–∞–Ω–¥—ã, –∑–æ–Ω –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, DevOps-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**.

–¢—ã —Ä–µ–∞–ª—å–Ω–æ –ø–æ–ª—É—á–∞–µ—à—å:

* üß© —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
* üîÅ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–Ω–æ–≥–∏–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏
* üîç –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è —Ä–µ–≤—å—é
* ‚öôÔ∏è –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å (–≤—Å–µ –º–æ–≥—É—Ç –≤–∑—è—Ç—å —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω)
* üö• –∫–æ–Ω—Ç—Ä–æ–ª—å —á–µ—Ä–µ–∑ Git + CI

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–≥—É –ø–æ–º–æ—á—å –æ—Ñ–æ—Ä–º–∏—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç **–≤ —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å —á–∏—Å—Ç—ã–º App of Apps –∏ ApplicationSet**, –∏ —Å–¥–µ–ª–∞—Ç—å Readme-–æ–ø–∏—Å–∞–Ω–∏–µ.
